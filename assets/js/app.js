!function(e){e.module("moviecat",["moviecat_home","moviecat_details","moviecat_movie_list"]).controller("searchCtrl",["$scope","$window",function(e,o){e.query=function(){var t=e.keyWord;o.location.hash="#/search?q="+t}}])}(angular),function(e){var o=e.module("moviecat_home",["ngRoute"]);o.config(["$locationProvider",function(e){e.hashPrefix("")}]),o.config(["$routeProvider",function(e){e.when("/home",{templateUrl:"./home/home.html"}).when("/",{redirectTo:"/home"})}])}(angular),function(e){var o=e.module("moviecat_details",["ngRoute","heima"]);o.config(["$routeProvider",function(e){e.when("/details/:id",{templateUrl:"./details/details.html",controller:"detailsCtrl"})}]),o.controller("detailsCtrl",["$scope","$routeParams","jsonp",function(e,o,t){t({url:"http://api.douban.com/v2/movie/subject/"+o.id,params:{},callback:function(o){e.movie=o,e.isShow=!1,e.$apply()}})}])}(angular),function(e){var o=e.module("moviecat_movie_list",["ngRoute","heima"]);o.config(["$routeProvider",function(e){e.when("/:movieType/:page?",{templateUrl:"./movie_list/movie_list.html",controller:"movie_listCtrl"})}]),o.controller("movie_listCtrl",["$scope","$routeParams","$route","$window","jsonp",function(e,o,t,a,i){e.isShow=!0,e.pageIndex=+(o.page||"1"),e.pageSize=10,i({url:"http://api.douban.com/v2/movie/"+o.movieType,params:{count:e.pageSize,start:(e.pageIndex-1)*e.pageSize,q:o.q},callback:function(o){e.movies=o,e.pageCount=a.Math.ceil(o.total/e.pageSize),e.isShow=!1,e.$apply()}}),e.getPage=function(o){o<1||o>e.pageCount||t.updateParams({page:o})}}])}(angular),function(e){var o=e.module("heima",[]),t=1;o.factory("jsonp",["$window",function(e){return function(o){var a=o.url+"?";for(var i in o.params)a+=i+"="+o.params[i]+"&";var n="hmCallback"+t++;window[n]=o.callback,a+="callback="+n;var r=e.document.createElement("script");r.src=a,e.document.body.appendChild(r)}}]),o.directive("hmActive",function(){return{restrict:"A",link:function(e,o,t){o.on("click",function(){o.parent().children().removeClass("active"),o.addClass("active")})}}})}(angular);